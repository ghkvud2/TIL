### ARQ (Automatic Repeat Request) 방식

- `ARQ`란 통신회선에서 오류가 발생하면 수신측은 송신측에 오류를 알리고, 송신측은 오류가 발생한 block 을 재전송하는 방식을 말한다.

---

### 1. Stop-And-Wait 방식

- 송수신측 모두 크기가 1인 슬라이딩 윈도우를 사용한다.

#### [송신측]

- 송신측은 한번에 하나의 패킷을 전송하고 `ACK이나 NAK 응답`이 돌아올때 까지 다음 패킷을 전송하지 않는다.
- 패킷을 전송한 후, 타이머를 작동시키는데 이 시간동안 수신측으로부터 `ACK 응답`을 받지 못할 경우 패킷이 손상되었다고 판단하여 패킷을 재전송한다.

#### [수신측]

- 수신측은 패킷을 검사하여 만일 패킷이 훼손되었다면 해당 패킷을 무시한다. 송신측에 `ACK 응답`을 보내지 않기 때문에, 송신측의 타이머가 만료되어 해당 패킷을 재전송 할 것을 기대한다.
- 수신측은 다음 패킷의 `확인응답 번호`를 저장하고 이 번호를 `ACK` 응답에 보내게 된다.
- 만약, 수신측이 보낸 `ACK 응답`이 손실되어 송신측에서 그 이전의 패킷을 보내는 경우 해당 패킷이 중복되었다는 것을 인식할 수 있다.

![](../자료/stopandwait.png)

---

### 2. Go-Back-N (슬라이딩 윈도우) 방식

- 송수신측이 같은 크기의 `윈도우`를 가지고 있어, 송신측이 전송한 데이터에대한 `ACK`를 받지 않았다고 하더라도 패킷을 전송할 수 있도록 하는 방식이다.
- 송신측이 수신측으로부터 `ACK` 를 받았다면, 송신측은 `윈도우`를 한칸 움직여서 그 다음 패킷을 전송한다.
- 즉, 송신측은 `윈도우` 크기만큼의 패킷을 전송하고, `ACK`를 받게되면 그때마다 `윈도우`를 슬라이딩 시켜 다음 패킷을 전송하는 기법이다.

![](http://www.ktword.co.kr//img_data/1469_2.JPG)

---

### 3. Selective-Repeat 방식

- 잘못된 패킷만 다시 보내는 방식이다.

---

### 4. 혼잡 제어

- 많은 사용자들이 동시에 많은 데이터를 전송할 경우 네트워크에 지연이 발생하는 상황을 제어하기 위한 기법이다.
- 즉, 네트워크가 수용할 수 없는 데이터 전송이 발생할 때 패킷의 손실이나 지연을 막기 위해 사용된다.



#### 4-1. 느린 시작 (Slow Start)

- 초기 혼잡 `윈도우`를 1로 지정하고, 수신측으로부터 `ACK`를 받을 경우, `윈도우`의 크기를 2배씩 증가시키는 방법이다.
- 전송되어지는 데이터의 크기가 미리 정해놓은 임계치에 도달하면, `혼잡 회피`단계로 넘어가게 된다.



#### 4-2. 혼잡 회피 (Congestion Avoidance)

- `혼잡 회피`알고리즘은 `느린 시작` 알고리즘을 통해 혼잡 윈도우의 크기가 지수배 만큼 증가하다가, 혼잡 윈도우의 임계치에 도달하면 적용되는 알고리즘이다.
- 즉, 혼잡 윈도우의 값을 1씩 증가시키면서 네트워크의 혼잡 상태를 감지하기 위해 작동한다.
- 만약, `혼잡 감지` 단계에서 수신측으로부터 ACK를 받지 못하거나 타임아웃되면 `혼잡 동작` 단계로 넘어가는데, 이때 윈도우의 값은 1로 리셋되고, `혼잡 윈도우`의 한계 값은 현재 `혼잡 윈도우`크기의 절반으로 수정된다.



#### * 동작 과정

1. 초기 `혼잡 윈도우`(a)를 1로 설정하고, `혼잡 윈도우`의 임계치(b) 를 설정한다.
2. 패킷을 전송한 뒤, `ACK 응답`을 받게되면, 혼잡 윈도우(a)의 값을 2배 증가시켜 패킷을 이어서 전송한다.
3. 혼잡 윈도우(a) 값이 임계치 (b)에 도달하면, `혼잡 회피 단계`로 넘어간다.
4. `혼잡 회피 단계`에서는 혼잡 윈도우(a) 값을 두 배가아닌 1씩 증가시키면서 패킷을 전송한다.
5. `혼잡 회피 단계`에서 패킷이 손상되었거나 전송에 오류가 발생하면 `혼잡 동작 단계`로 넘어간다.
6. `혼잡 동작 단계`에서는 혼잡 윈도우(a) 값을 다시 1로 초기화 시키고 혼잡 윈도우의 임계치(b)도 초기 값의 절반으로 줄인다.